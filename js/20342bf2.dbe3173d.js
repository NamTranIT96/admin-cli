(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["20342bf2"],{3624:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"list-coupon-wrapper"},[o("div",{staticClass:"q-pa-md q-gutter-sm"},[o("div",{staticClass:"title-and-controller flex"},[o("div",{staticClass:"text-title"},[t._v("Coupon management")]),o("q-space"),o("q-btn",{staticClass:"q-mr-md",attrs:{icon:"add",size:"md",label:"Add","no-caps":"",color:"primary"},on:{click:function(e){return t.openDialogNewCoupon()}}}),o("q-btn",{staticClass:"q-mr-md",attrs:{icon:"edit",size:"md",disable:0==t.listSelected.length,color:"secondary","no-caps":"",label:"Edit"},on:{click:function(e){return t.triggerOpenModalEditCoupon()}}}),o("q-btn",{attrs:{disable:0==t.listSelected.length,color:"negative",size:"md",icon:"delete","no-caps":"",label:"Delete"},on:{click:function(e){return t.triggerDeleteCoupon()}}})],1)]),o("div",{staticClass:"list-user q-pa-md"},[o("q-table",{staticClass:"table-list-user",attrs:{data:t.list_coupon,columns:t.columns,"row-key":"stt",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"header-cell",fn:function(e){return[o("q-th",{attrs:{props:e}},["check_select"==e.col.unique?o("div",[o("div",[t._v("Â ")])]):o("div",[o("div",{staticClass:"text-custom-header"},[t._v(t._s(e.col.label))])])])]}},{key:"body",fn:function(e){return[o("q-tr",{attrs:{props:e}},[o("q-td",{key:"check_select",staticStyle:{width:"50px"},attrs:{props:e}},[o("q-checkbox",{staticClass:"checkbox-select-list-booking",attrs:{disable:e.row.disable_selected,color:"primary"},nativeOn:{click:function(o){return t.changeCheckbox(e.row)}},model:{value:e.row.check_select,callback:function(o){t.$set(e.row,"check_select",o)},expression:"props.row.check_select"}})],1),o("q-td",{key:"no",staticStyle:{width:"50px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(e.row.stt))])]),o("q-td",{key:"code",staticStyle:{width:"210px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(e.row.code))])]),o("q-td",{key:"totalAmount",staticStyle:{width:"200px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(t._f("currency")(e.row.totalAmount,t.option_filter))+"\n            ")])]),o("q-td",{key:"usedAmount",staticStyle:{width:"200px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[o("div",[t._v(t._s(e.row.usedAmount))])])]),o("q-td",{key:"type",staticStyle:{width:"200px"},attrs:{props:e}},[0==e.row.type?o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v("Fixed amount\n            ")]):t._e(),1==e.row.type?o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v("Percent valuation\n            ")]):t._e()]),o("q-td",{key:"value",staticStyle:{width:"200px"},attrs:{props:e}},[0==e.row.type?o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(t._f("currency")(e.row.value,t.option_filter))+"\n            ")]):t._e(),1==e.row.type?o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(e.row.value)+" %\n            ")]):t._e()]),o("q-td",{key:"startTime",staticStyle:{width:"200px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(t._f("formatDateSystem")(e.row.startTime))+"\n            ")])]),o("q-td",{key:"endTime",staticStyle:{width:"200px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[t._v(t._s(t._f("formatDateSystem")(e.row.endTime))+"\n            ")])]),o("q-td",{key:"status",staticStyle:{width:"200px"},attrs:{props:e}},[o("div",{staticClass:"data-wrapper",on:{click:function(o){return t.openModalViewCoupon(e.row)}}},[o("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"Active","inactive-text":"Inactive"},on:{change:function(o){return t.changeStatusCoupon(e.row)}},model:{value:e.row.status,callback:function(o){t.$set(e.row,"status",o)},expression:"props.row.status"}})],1)])],1)]}}])})],1),o("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale"},model:{value:t.trigger_dialog_new_coupon,callback:function(e){t.trigger_dialog_new_coupon=e},expression:"trigger_dialog_new_coupon"}},[o("q-card",{staticClass:"bg-primary text-white",staticStyle:{width:"700px","max-width":"700px"}},[t.is_edit_coupon?o("q-card-actions",{staticClass:"section-header-detail-booking q-pa-md"},[t._v("Edit user coupon")]):o("q-card-actions",{staticClass:"section-header-detail-booking q-pa-md"},[t._v("Add new coupon\n      ")]),o("q-card-actions",{staticClass:"bg-white text-black q-pa-md"},[o("div",{staticClass:"w-100"},[o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Coupon Code")]),o("div",[o("el-input",{attrs:{placeholder:"Please input code",disabled:t.is_edit_coupon},model:{value:t.info_new_coupon.code,callback:function(e){t.$set(t.info_new_coupon,"code",e)},expression:"info_new_coupon.code"}})],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Description")]),o("div",[o("el-input",{attrs:{type:"textarea",placeholder:"Please input description",disabled:t.is_edit_coupon},model:{value:t.info_new_coupon.description,callback:function(e){t.$set(t.info_new_coupon,"description",e)},expression:"info_new_coupon.description"}})],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Usage Limited")]),o("div",[o("el-input-number",{staticClass:"input-number-price",attrs:{controls:!1},model:{value:t.info_new_coupon.totalAmount,callback:function(e){t.$set(t.info_new_coupon,"totalAmount",e)},expression:"info_new_coupon.totalAmount"}})],1)]),t.info_new_coupon.is_admin?t._e():o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Product apply")]),o("div",[o("el-select",{staticClass:"w-100",attrs:{"popper-class":"popper-choose-group-permission",placeholder:"Select product apply",multiple:""},model:{value:t.info_new_coupon.productIdsApplied,callback:function(e){t.$set(t.info_new_coupon,"productIdsApplied",e)},expression:"info_new_coupon.productIdsApplied"}},t._l(t.list_product,(function(t){return o("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1)],1)]),t.info_new_coupon.is_admin?t._e():o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Coupon type")]),o("div",[o("el-select",{staticClass:"w-100",attrs:{"popper-class":"popper-choose-group-permission",placeholder:"Select type coupon"},model:{value:t.info_new_coupon.type,callback:function(e){t.$set(t.info_new_coupon,"type",e)},expression:"info_new_coupon.type"}},t._l(t.list_type_coupon,(function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Value of coupon")]),o("div",[o("el-input-number",{staticClass:"input-number-price",attrs:{controls:!1},model:{value:t.info_new_coupon.value,callback:function(e){t.$set(t.info_new_coupon,"value",e)},expression:"info_new_coupon.value"}})],1),o("div",{staticClass:"q-mt-sm"},[0==t.info_new_coupon.type?o("el-alert",{attrs:{title:"Value of coupon type 'Fixed amount' is fixed price reduction.",type:"info",closable:!1,"show-icon":""}}):t._e(),1==t.info_new_coupon.type?o("el-alert",{attrs:{title:"Value of coupon type 'Percent valuation' is the percentage of the reduced amount ( 0 <= value <= 100).",type:"info",closable:!1,"show-icon":""}}):t._e()],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Start time")]),o("div",[o("el-date-picker",{staticClass:"time-picker-w-100",attrs:{type:"date",placeholder:"Pick start time apply","popper-class":"date-picker-z-index",format:"dd-MM-yyyy"},model:{value:t.info_new_coupon.startTime,callback:function(e){t.$set(t.info_new_coupon,"startTime",e)},expression:"info_new_coupon.startTime"}})],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("End time")]),o("div",[o("el-date-picker",{staticClass:"time-picker-w-100",attrs:{type:"date",placeholder:"Pick end time apply","popper-class":"date-picker-z-index",format:"dd-MM-yyyy"},model:{value:t.info_new_coupon.endTime,callback:function(e){t.$set(t.info_new_coupon,"endTime",e)},expression:"info_new_coupon.endTime"}})],1)]),o("div",{staticClass:"q-mb-md"},[o("div",[t._v("Status")]),o("div",[o("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"Active","inactive-text":"Inactive"},model:{value:t.info_new_coupon.status,callback:function(e){t.$set(t.info_new_coupon,"status",e)},expression:"info_new_coupon.status"}})],1)])])]),o("q-separator"),o("q-card-actions",{staticClass:"bg-white text-teal q-pa-md",attrs:{align:"right"}},[o("div",[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{label:"cancel",color:"white","text-color":"black",icon:"cancel","no-caps":""}}),t.is_edit_coupon?o("q-btn",{attrs:{label:"Save info","no-caps":"",color:"primary",icon:"add"},on:{click:function(e){return t.editCouponAPI()}}}):o("q-btn",{attrs:{label:"Add new coupon","no-caps":"",color:"primary",icon:"add"},on:{click:function(e){return t.addNewCouponAPI()}}})],1)])],1)],1)],1)},i=[],a=(o("8e6e"),o("8a81"),o("ac6a"),o("cadf"),o("06db"),o("456d"),o("c47a")),s=o.n(a),c=o("2f62"),r=o("e71f");function l(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function p(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?l(o,!0).forEach((function(e){s()(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):l(o).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={name:"List-coupon-page",filters:{},computed:p({},Object(c["b"])({current_user_logged_info:"login/getUserLoggedInfo",current_branch_id:"login/getCurrentBranchId",regional_branch:"login/getInfoRegionalBranch"}),{listSelected:function(){var t=[];return this.list_coupon.forEach((function(e){e.check_select&&t.push(e)})),t}}),watch:{regional_branch:function(t){t&&t.mainCurrency&&(this.money_option=Object(r["a"])(parseInt(t.mainCurrency)),1==parseInt(t.mainCurrency)&&(this.option_filter={symbol:"",thousandsSeparator:",",fractionCount:0,fractionSeparator:".",display_symbol:"VND"}),2==parseInt(t.mainCurrency)&&(this.option_filter={symbol:"",thousandsSeparator:",",fractionCount:2,fractionSeparator:".",display_symbol:"$"}),this.$forceUpdate())},current_branch_id:function(t){!isNaN(t)&&parseInt(t)>0&&(this.getListCoupon(),this.getListProduct())}},data:function(){return{option_filter:{symbol:"",thousandsSeparator:",",fractionCount:0,fractionSeparator:".",display_symbol:"VND"},tab:"details",pagination:{sortBy:"stt",descending:!1,page:1,rowsPerPage:10},selected:[],columns:[{style:"width: 50px",name:"check_select",label:"check_select",unique:"check_select",align:"left",field:"check_select"},{style:"width: 50px",name:"no",label:"No",unique:"no",align:"left",field:"stt"},{name:"code",align:"left",label:"Code",unique:"code",field:"code",style:"width: 200px"},{name:"totalAmount",align:"left",label:"Total Amount",unique:"totalAmount",field:"totalAmount",style:"width: 200px"},{name:"usedAmount",align:"left",label:"Used Amount",unique:"usedAmount",field:"usedAmount",style:"width: 200px"},{name:"type",align:"left",label:"Type",unique:"type",field:"type",style:"width: 200px"},{name:"value",align:"left",label:"Value",unique:"value",field:"value",style:"width: 200px"},{name:"startTime",align:"left",label:"Start Time",unique:"startTime",field:"startTime",style:"width: 200px"},{name:"endTime",align:"left",label:"End Time",unique:"endTime",field:"endTime",style:"width: 200px"},{name:"status",align:"left",label:"Status",unique:"status",field:"status",style:"width: 210px"}],current_booking_select_to_view:{},trigger_dialog_new_coupon:!1,is_edit_coupon:!1,info_new_coupon:{branchId:null,code:"",status:!0,totalAmount:0,productIdsApplied:[],type:0,value:0,startTime:new Date,endTime:""},list_coupon:[],list_product:[],list_type_coupon:[{id:0,name:"Fixed amount"},{id:1,name:"Percent valuation"}]}},methods:{changeStatusCoupon:function(t){var e=this,o={id:t.id,status:t.status},n=localStorage.getItem("user_token_fisheye_client");this.$axios.put("/api/Coupons/Update",JSON.stringify(o),{headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}).then((function(t){e.$q.notify({color:"secondary",position:"top-right",icon:"tag_faces",message:"Change status coupon Successfully"})})).catch((function(o){t.status=!t.status,o.response.data?e.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:o.response.data}):e.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))},triggerOpenModalEditCoupon:function(){var t=JSON.parse(JSON.stringify(this.listSelected[0])),e=[];t.productIdsApplied.forEach((function(t){e.push(parseInt(t))})),t.productIdsApplied=e,this.info_new_coupon=t,this.is_edit_coupon=!0,this.trigger_dialog_new_coupon=!0},changeCheckbox:function(t){this.list_coupon.forEach((function(e){e.id!=t.id&&(e.check_select=!1)})),this.$forceUpdate()},checkValidateCoupon:function(){var t=this;return""==t.info_new_coupon.code?(t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Coupon code not empty"}),!1):""===t.info_new_coupon.totalAmount||void 0==t.info_new_coupon.totalAmount?(t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Usage Limited not empty"}),!1):0==t.info_new_coupon.productIdsApplied.length?(t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Please choose product applied"}),!1):!(1==t.info_new_coupon.type&&t.info_new_coupon.value>100)||(t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Value of coupon which have type 'Percent valuation' is not greater 100 "}),!1)},addNewCouponAPI:function(){var t=this;if(t.checkValidateCoupon()){var e=this.info_new_coupon;e.branchId=this.current_branch_id;var o=localStorage.getItem("user_token_fisheye_client");this.$axios.post("/api/Coupons/Create",JSON.stringify(e),{headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"}}).then((function(e){t.getListCoupon(),t.trigger_dialog_new_coupon=!1,t.$q.notify({color:"secondary",position:"top-right",icon:"tag_faces",message:"Create Successfully"})})).catch((function(e){t.trigger_dialog_new_coupon=!1,e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}},editCouponAPI:function(){var t=this;if(t.checkValidateCoupon()){var e=this.info_new_coupon,o=localStorage.getItem("user_token_fisheye_client");this.$axios.put("/api/Coupons/Update",JSON.stringify(e),{headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"}}).then((function(e){t.getListCoupon(),t.trigger_dialog_new_coupon=!1,t.$q.notify({color:"secondary",position:"top-right",icon:"tag_faces",message:"Edit Successfully"})})).catch((function(e){t.trigger_dialog_new_coupon=!1,e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}},openDialogNewCoupon:function(){var t=this;t.info_new_coupon={branchId:null,code:"",description:"",status:!0,totalAmount:0,productIdsApplied:[],type:0,value:0,startTime:new Date,endTime:""},t.is_edit_coupon=!1,t.trigger_dialog_new_coupon=!0},openModalViewCoupon:function(t){},deleteCouponAPI:function(){var t=this,e=this.current_branch_id;if(-1!=e&&e){t=this;var o=localStorage.getItem("user_token_fisheye_client"),n={id:t.listSelected[0].id};t.$axios.delete("/api/Coupons/Delete",{data:n,headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"}}).then((function(e){t.$q.notify({color:"secondary",position:"top-right",icon:"tag_faces",message:"Delete coupon Successfully"}),t.getListCoupon()})).catch((function(e){e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}},triggerDeleteCoupon:function(){var t=this;this.$swal({title:"Are you sure?",text:"You will not be able to recover this data!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then((function(e){e.value&&t.deleteCouponAPI()}))},getListCoupon:function(){var t=this,e=localStorage.getItem("branch_id_fisheye_client"),o=localStorage.getItem("user_token_fisheye_client");this.$axios.get("/api/Coupons/Get?branchId="+e+"&PageSize=1000",{headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"}}).then((function(e){e.data.coupons.forEach((function(t,e){t.stt=e+1,t.disable_selected=!1,t.check_select=!1})),t.list_coupon=e.data.coupons,t.$forceUpdate()})).catch((function(t){}))},getListProduct:function(){var t=this,e=localStorage.getItem("user_token_fisheye_client"),o=localStorage.getItem("branch_id_fisheye_client");-1!=this.current_branch_id&&this.$axios.get("/api/Products/GetProductList?BranchId="+o+"&Status=1&PageSize=1000",{headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then((function(e){t.list_product=e.data.products})).catch((function(e){t.loading_main=!1,e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}},mounted:function(){this.getListCoupon(),this.getListProduct()}},d=u,_=(o("643d"),o("2877")),f=o("fe09"),m=Object(_["a"])(d,n,i,!1,null,null,null);e["default"]=m.exports;m.options.components=Object.assign({QSpace:f["D"],QBtn:f["c"],QTable:f["I"],QTh:f["L"],QTr:f["Q"],QTd:f["K"],QCheckbox:f["h"],QDialog:f["k"],QCard:f["e"],QCardActions:f["f"],QSeparator:f["C"]},m.options.components||{}),m.options.directives=Object.assign({ClosePopup:f["a"]},m.options.directives||{})},"643d":function(t,e,o){"use strict";var n=o("de23"),i=o.n(n);i.a},de23:function(t,e,o){},e71f:function(t,e,o){"use strict";function n(t){return 1==t?{decimal:".",thousands:",",prefix:"",suffix:"",precision:0,masked:!1}:2==t?{decimal:".",thousands:",",prefix:"",suffix:"",precision:2,masked:!1}:void 0}e["a"]=n}}]);