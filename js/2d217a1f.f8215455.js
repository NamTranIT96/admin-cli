(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d217a1f"],{c80d:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",{staticClass:"page-create-product-wrapper"},[o("div",{staticClass:"q-pa-lg content-of-each-step"},[o("div",{staticClass:"step-1"},[o("q-card",{staticClass:"card-step-1 w-100-per-mobile"},[o("q-card-section",[o("div",{staticClass:"step-1-content"},[o("div",{staticClass:"text-main q-pt-lg q-pl-lg q-pr-lg"},[t._v("Add Photos")]),o("div",{staticClass:"sub-text-2 q-pl-lg q-pr-lg"},[t._v("\n              Use photos that highlight what’s unique about your experience\n              and show travelers having fun.\n            ")]),o("div",{staticClass:"sub-text-2 q-pl-lg q-pr-lg"},[o("strong",[t._v("Adding 1-9 photos can increase your bookings.")])]),o("div",{staticClass:"q-pl-lg q-pr-lg q-pt-lg"},[0==t.list_image_upload.length?o("div",{staticClass:"add-photo-wrapper",on:{click:function(e){t.showUploadImage=!0}}},[o("div",{staticClass:"icon-and-text-add-photo flex justify-between items-center"},[o("div",{staticClass:"w-100 text-center"},[o("div",[o("q-icon",{staticStyle:{"font-size":"4.4em"},attrs:{name:"add",color:"grey"}})],1),o("div",{staticClass:"text-add"},[t._v("Add photos")])])])]):o("div",{staticClass:"image-cover-media-main"},[o("div",{staticClass:"image-cover-wrapper"},[o("img",{attrs:{src:t.backend_url+t.list_image_upload[0]}}),o("div",{staticClass:"note-is-cover"},[t._v("Cover")]),o("div",{staticClass:"delete-wrapper",on:{click:function(e){return t.warningRemoveImage(t.list_image_upload[0])}}},[o("q-icon",{attrs:{name:"delete",color:"white",size:"sm"}})],1)]),o("div",{staticClass:"add-more-image-wrapper flex items-center"},[o("div",{staticClass:"add-photo-wrapper",on:{click:function(e){t.showUploadImage=!0}}},[o("div",{staticClass:"icon-and-text-add-photo-mobile flex justify-between items-center"},[o("div",{staticClass:"w-100 text-center"},[o("div",[o("q-icon",{staticStyle:{"font-size":"4.4em"},attrs:{name:"add",color:"grey"}})],1),o("div",{staticClass:"text-add"},[t._v("Add photos")])])])]),o("div",{staticClass:"list-image-media-wrapper flex"},t._l(t.list_image_upload,(function(e,i){return o("div",{key:i,staticClass:"item-image-wrapper"},[0!=i?o("div",{staticClass:"item-image"},[o("img",{attrs:{src:t.backend_url+e}}),o("div",{staticClass:"delete-wrapper",on:{click:function(o){return t.warningRemoveImage(e)}}},[o("q-icon",{attrs:{name:"delete",color:"white",size:"sm"}})],1),o("div",{staticClass:"set-to-cover",on:{click:function(o){return t.setCover(e)}}},[t._v("Set Cover")])]):t._e()])})),0)])]),o("my-upload",{ref:"upload_image_product",attrs:{field:"file",noCircle:!0,"lang-type":"en",width:800,height:600,url:t.backend_url+"api/Media/AddPhoto",params:t.params,headers:t.headers},on:{"crop-success":t.cropSuccess,"crop-upload-success":t.cropUploadSuccessUploadLogo,"crop-upload-fail":t.cropUploadFail},model:{value:t.showUploadImage,callback:function(e){t.showUploadImage=e},expression:"showUploadImage"}}),t.is_error?o("div",{staticClass:"q-mt-lg error-content",staticStyle:{"font-size":"20px"}},[t._v("Photo must be from 1 to 9 pictures\n              ")]):t._e()],1),o("div",{staticClass:"q-pa-lg"},[o("q-btn",{staticClass:"q-mt-lg w-100-per-mobile",attrs:{color:"primary",label:"Save & continue",size:"lg","no-caps":""},on:{click:function(e){return t.gotoProductContent()}}})],1)])])],1)],1)])])},s=[],a=(o("c5f6"),o("0b4d")),r=o("9c58"),n={name:"create-product-page",props:{props_id_product:{type:Number,default:-1}},watch:{props_id_product:function(t){-1!=this.props_id_product&&self.props_id_product&&(this.$emit("getProductId",this.props_id_product),this.getInfoProductEdit())}},filters:{},computed:{is_error:function(){return!(!(this.list_image_upload.length<1||this.list_image_upload.length>10)||!this.is_touch)}},data:function(){return{is_touch:!1,backend_url:r["a"],showUploadImage:!1,langvn:{hint:"Click hoặc kéo thả hình ảnh vào đây để tải lên",loading:"Đang tải…",noSupported:"Trình duyệt hiện tại không hổ trợ, hãy sử dụng IE10+ hoặc trình duyệt khác.",success:"Tải lên thành công",fail:"Tải lên thất bại",preview:"Xem trước",btn:{off:"Hủy",close:"Đóng",back:"Trở lại",save:"Lưu"},error:{onlyImg:"Chỉ đăng hình",outOfSize:"Hình ảnh vượt quá giới hạn kích thước: ",lowestPx:"Kích thước hình ảnh quá nhỏ, kích thước ít nhất: "}},params:{token:"123456798",name:"avatar"},headers:{},list_image_upload:[],imgDataUrl:"",current_product_edited:{}}},methods:{warningRemoveImage:function(t){var e=this;this.$confirm("Will remove this image?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.removeImage(t)})).catch((function(){}))},removeImage:function(t){var e=this.list_image_upload.indexOf(t);-1!=e&&this.list_image_upload.splice(e,1),this.$forceUpdate()},checkValidate:function(){var t=this;return t.is_touch=!0,this.list_image_upload.length>=1&&this.list_image_upload.length<=10},gotoProductContent:function(){if(this.checkValidate()){var t=this,e=localStorage.getItem("user_token_fisheye_client"),o=this.$route.params.product_id,i={productId:parseInt(o),photos:t.list_image_upload};2==t.current_product_edited.stepCreation&&(i.stepCreation=3),this.$axios.put("/api/Products/UpdateBasicInfo",JSON.stringify(i),{headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}}).then((function(e){t.$q.notify({color:"secondary",position:"top-right",icon:"tag_faces",message:"Update Successfully"}),-1!=t.props_id_product&&t.props_id_product?t.$emit("done"):t.$router.push("/products/create/content/departureAndReturn/"+o)})).catch((function(e){e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}},cropUploadFail:function(t,e){console.log("-------- upload fail --------"),console.log(t),console.log("field: "+e)},cropSuccess:function(t,e){console.log("-------- crop success --------"),this.imgDataUrl=t},cropUploadSuccessUploadLogo:function(t,e){this.list_image_upload.push(t.url),this.showUploadImage=!1,this.is_touch=!1,this.$refs.upload_image_product.step=1,console.log("-------- upload success --------"),console.log(t),console.log("field: "+e)},setCover:function(t){var e=this.list_image_upload.indexOf(t);-1!=e&&(this.list_image_upload.splice(e,1),this.list_image_upload.unshift(t)),this.$forceUpdate()},initDataEdit:function(){this.current_product_edited.photos?this.list_image_upload=this.current_product_edited.photos:this.list_image_upload=[]},getInfoProductEdit:function(){var t=this,e=this.$route.params.product_id;if(e){var o=localStorage.getItem("user_token_fisheye_client");this.$axios.get("/api/Products/GetProductDetail/"+e,{headers:{Authorization:"Bearer "+o,"Content-Type":"application/json"}}).then((function(e){t.current_product_edited=e.data,t.initDataEdit()})).catch((function(e){e.response.data?t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:e.response.data}):t.$q.notify({color:"negative",icon:"report_problem",position:"top-right",message:"Have Error"})}))}}},components:{"my-upload":a["a"]},mounted:function(){var t=localStorage.getItem("user_token_fisheye_client");this.headers={Authorization:"Bearer "+t};var e=this.$route.params.product_id;e&&(this.$emit("getProductId",e),this.getInfoProductEdit()),-1!=this.props_id_product&&self.props_id_product&&(this.$emit("getProductId",this.props_id_product),this.getInfoProductEdit())}},c=n,l=o("2877"),d=o("fe09"),p=Object(l["a"])(c,i,s,!1,null,"387ebaaa",null);e["default"]=p.exports;p.options.components=Object.assign({QPage:d["y"],QCard:d["e"],QCardSection:d["g"],QIcon:d["n"],QBtn:d["c"]},p.options.components||{})}}]);